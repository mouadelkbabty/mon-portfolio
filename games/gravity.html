<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>Gravity Skills | Portfolio</title>
    <style>
        body { margin: 0; padding: 0; overflow: hidden; background: #0A0E27; user-select: none; }
        
        #instructions {
            position: absolute; top: 20px; width: 100%; text-align: center;
            color: rgba(255, 255, 255, 0.5); font-family: sans-serif; pointer-events: none;
        }
        
        .back-btn {
            position: absolute; bottom: 30px; left: 50%; transform: translateX(-50%);
            background: #00F0FF; color: #0A0E27; padding: 12px 24px;
            text-decoration: none; font-family: sans-serif; font-weight: bold;
            border-radius: 25px; z-index: 100; opacity: 0.8; transition: 0.3s;
        }
        .back-btn:hover { opacity: 1; transform: translateX(-50%) scale(1.1); }
    </style>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/matter-js/0.19.0/matter.min.js"></script>
</head>
<body>

    <div id="instructions">Attrape les blocs et jette-les ! üñ±Ô∏è</div>
    <a href="../games.html" class="back-btn">Retour au Menu</a>

    <script>
        // Module aliases
        var Engine = Matter.Engine,
            Render = Matter.Render,
            Runner = Matter.Runner,
            Bodies = Matter.Bodies,
            Composite = Matter.Composite,
            Mouse = Matter.Mouse,
            MouseConstraint = Matter.MouseConstraint,
            Events = Matter.Events;

        // Create engine
        var engine = Engine.create();
        var world = engine.world;

        // Create renderer
        var render = Render.create({
            element: document.body,
            engine: engine,
            options: {
                width: window.innerWidth,
                height: window.innerHeight,
                wireframes: false, // Important pour voir les couleurs
                background: '#0A0E27'
            }
        });

        // --- SKILLS DATA ---
        const skills = [
            { text: "HTML5", color: "#E34F26" },
            { text: "CSS3", color: "#1572B6" },
            { text: "JS", color: "#F7DF1E", textColor: "#000" },
            { text: "React", color: "#61DAFB", textColor: "#000" },
            { text: "Node", color: "#339933" },
            { text: "ThreeJS", color: "#000000", border: "#FFF" },
            { text: "Git", color: "#F05032" },
            { text: "Figma", color: "#F24E1E" },
            { text: "UI/UX", color: "#A259FF" },
            { text: "SQL", color: "#003B57" }
        ];

        // --- CREATE OBJECTS ---
        const boxes = [];
        
        skills.forEach((skill, i) => {
            // Random positions
            const x = Math.random() * window.innerWidth;
            const y = -Math.random() * 500 - 100; // Drop from above

            const box = Bodies.rectangle(x, y, 120, 60, {
                chamfer: { radius: 10 }, // Rounded corners
                render: {
                    fillStyle: skill.color,
                    strokeStyle: skill.border || 'transparent',
                    lineWidth: 2
                },
                label: skill.text // Store text here
            });
            
            // Custom property to store text color
            box.textColor = skill.textColor || '#FFFFFF';
            
            boxes.push(box);
        });

        // Walls (Sol, Plafond, Murs)
        const wallOptions = { isStatic: true, render: { fillStyle: '#1A1F3A' } };
        const ground = Bodies.rectangle(window.innerWidth/2, window.innerHeight + 30, window.innerWidth, 60, wallOptions);
        const leftWall = Bodies.rectangle(-30, window.innerHeight/2, 60, window.innerHeight, wallOptions);
        const rightWall = Bodies.rectangle(window.innerWidth + 30, window.innerHeight/2, 60, window.innerHeight, wallOptions);
        
        Composite.add(world, [...boxes, ground, leftWall, rightWall]);

        // Mouse Control
        var mouse = Mouse.create(render.canvas);
        var mouseConstraint = MouseConstraint.create(engine, {
            mouse: mouse,
            constraint: {
                stiffness: 0.2,
                render: { visible: false }
            }
        });
        Composite.add(world, mouseConstraint);
        render.mouse = mouse;

        // --- CUSTOM RENDERING (TEXT) ---
        Events.on(render, 'afterRender', function() {
            var context = render.context;
            context.font = "bold 20px 'DM Sans', sans-serif";
            context.textAlign = "center";
            context.textBaseline = "middle";

            boxes.forEach(box => {
                var pos = box.position;
                var angle = box.angle;

                context.save();
                context.translate(pos.x, pos.y);
                context.rotate(angle);
                context.fillStyle = box.textColor;
                context.fillText(box.label, 0, 0);
                context.restore();
            });
        });

        // Run
        Render.run(render);
        var runner = Runner.create();
        Runner.run(runner, engine);

        // Resize handler
        window.addEventListener('resize', () => {
            render.canvas.width = window.innerWidth;
            render.canvas.height = window.innerHeight;
            
            // Reposition ground and walls
            Matter.Body.setPosition(ground, { x: window.innerWidth/2, y: window.innerHeight + 30 });
            Matter.Body.setPosition(rightWall, { x: window.innerWidth + 30, y: window.innerHeight/2 });
        });

    </script>
</body>
</html>